import{u as V,D as M,r as c,j as e,P as E}from"./index-gIg6QK8U.js";function H(){const{user:x,fetchWithAuth:v}=V(),i=M(),h=x&&(x.UserID||x.userId||x.UserId||x.id||x.ID),[f,N]=c.useState([]),[P,k]=c.useState([]),[s,l]=c.useState({FarmTypeCode:"LAYER",FarmID:"",FarmerID:"",AdvisorID:"",VisitDate:new Date().toISOString().slice(0,16),VisitPurpose:"",VisitStatusID:"",ScheduledStartTime:"",ScheduledEndTime:"",ActualStartTime:"",ActualEndTime:"",DurationMinutes:"",VisitOutcome:"",Location:"",AssignedTo:h||"",Findings:"",Recommendations:"",NextVisitDate:"",VisitPriority:"Normal",LayerFarmType:"",Breed:"",FlockSize:"",AgeInWeeks:"",FeedingManagement:"",FeedIntakePerChickenGm:"",WaterInTakePerChicken:"",FeedLeftOver:"",FLOHowMuchPDay:"",WaterIntakePerDay:"",FlockDensity:"",AvgBodyWeightKg:"",Ventilation:"",HouseTemperature:"",Humidity:"",DrinkerType:"",NumberofDrinker:"",FeederType:"",NumberofFeeder:"",VaccinationsGiven:!1,VaccinationNote:"",BiosecurityComment:"",EggProductionPercent:"",FarmHygieneComment:"",EggSizeAvgWeightGm:"",EggAbnormality:"",YolkColor:"",EggShellColor:"",EggProductionDeclinePrev1Week:"",MortalityTotal:"",MortalityRecent2Weeks:"",DiseaseHistory:"",AbnormalSigns:"",PostmortemFindings:"",CustomerFeedbackOnAKF:"",RecommendationGiven:"",SampleTaken:!1,SampleType:"",AnalysisRequest:"",AnyPictureRelatedtoVisit:"",LactationCows:"",DryCows:"",Heifers:"",Calves:"",Buls:"",BodyCondition:"",FeedingPerCow:"",HowTheyGiveForCos:"",UsesConcentrate:!1,WhichCompany:"",IsLocalMix:!1,ListofIngridiant:"",SampleCollection:"",HasForage:!1,TypeOfForage:"",ForageAmount:"",ConcentrateFeedSample:!1,AmountofWaterProvided:"",ManureScore1:"",ManureScore2:"",ManureScore3:"",ManureScore4:"",DairyVentilation:"",LightIntensity:"",BeddingType:"",SpaceAvailability:"",VaccinationHistory:"",BreedingHistory:"",BreedingMethod:"",AreTheyUsingNaturalorAI:"",InseminationFrequency:"",CalvingInterval:"",AgeAtFirstCalving:"",LitterCondition:"",AvgMilkProductionPerDay:"",MaxMilkProductionPerCow:"",TotalMilkPerDay:"",MilkSupplyTo:"",MilkPricePerLitter:"",Medication:!1,WhatTypeofMedication:"",IssuesComplaints:"",AnalyzeRequested:"",RecommendationAdvice:"",FeedBackOnAKF:"",AnyRelatedEvidenceImage:""}),[C,w]=c.useState(!1),[p,b]=c.useState(null),[j,F]=c.useState(!0),[m,y]=c.useState("visit"),[u,A]=c.useState({}),S=async t=>{if(t.preventDefault(),b(null),!h)return b({type:"error",text:"You must be signed in"});const a=L(s,h);if(a&&Object.keys(a).length>0)return A(a),a._tab&&y(a._tab),b({type:"error",text:"Please fix the highlighted errors"});A({});const r={};for(const n of Object.keys(s)){const o=s[n];typeof o=="string"?r[n]=o.trim()===""?null:o:r[n]=o}r.AssignedTo=r.AssignedTo||h,r.CreatedBy=h,r.VisitDate=s.VisitDate?new Date(s.VisitDate).toISOString():new Date().toISOString(),w(!0);try{const n=await v({url:"/farm-visit/create-with-details",method:"post",data:r});n?.data?.success?(b({type:"success",text:"Farm visit created"}),l(o=>({...o,VisitPurpose:"",Location:"",Breed:"",FlockSize:"",AgeInWeeks:"",LactationCows:"",AvgMilkProductionPerDay:"",TotalMilkPerDay:""}))):b({type:"error",text:n?.data?.message||"Unexpected response"})}catch(n){console.error("create farm visit error",n),b({type:"error",text:n?.response?.data?.message||n.message||"Failed to create"})}finally{w(!1)}};c.useEffect(()=>{let t=!0;try{const r=new URLSearchParams(i.search||""),n=r.get("visitId")||i.state&&i.state.visitId,o=r.get("farmType")||i.state&&i.state.farmType,g=r.get("AdvisorID")||i.state&&i.state.AdvisorID||r.get("advisor"),D=r.get("FarmID")||i.state&&i.state.FarmID||r.get("farm"),T=r.get("VisitPurpose")||i.state&&i.state.VisitPurpose||r.get("purpose"),I=r.get("AssignTo")||i.state&&i.state.AssignTo||r.get("assignTo");n&&l(d=>({...d,VisitId:n})),o&&l(d=>({...d,FarmTypeCode:(o||"").toUpperCase()})),g&&l(d=>({...d,AdvisorID:g})),D&&l(d=>({...d,FarmID:D})),T&&l(d=>({...d,VisitPurpose:T})),I&&l(d=>({...d,AssignedTo:I}))}catch{}async function a(){F(!0);try{const r=await v({url:"/employees",method:"get"}),n=r?.data?.data||r?.data||[],o=await v({url:"/farmers",method:"get"}),g=o?.data?.data||o?.data||[];if(!t)return;N(Array.isArray(n)?n:[]),k(Array.isArray(g)?g:[])}catch(r){console.error("Failed to load employees/farmers",r),N([]),k([])}finally{t&&F(!1)}}return a(),()=>{t=!1}},[v]);function L(t,a){const r={};return a||(r.CreatedBy="You must be signed in"),(!t.FarmTypeCode||typeof t.FarmTypeCode=="string"&&t.FarmTypeCode.trim()==="")&&(r.FarmTypeCode="Farm type is required",r._tab="visit"),(!t.FarmID||t.FarmID===null)&&(!t.FarmerID||t.FarmerID===null)&&(r.FarmOrFarmer="Either Farm or Farmer must be selected",r._tab=r._tab||"visit"),t.VisitDate||(r.VisitDate="Visit date is required",r._tab=r._tab||"visit"),(t.FarmTypeCode||"").toUpperCase()==="LAYER"&&(!t.Breed||t.Breed===null)&&!t.FlockSize&&t.FlockSize!==0&&(r.LayerHint="At least Breed or Flock Size is recommended for layer visits",r._tab=r._tab||"layer"),(t.FarmTypeCode||"").toUpperCase()==="DAIRY"&&!t.LactationCows&&t.LactationCows!==0&&!t.TotalMilkPerDay&&t.TotalMilkPerDay!==0&&(r.DairyHint="Provide Lactation Cows or Total Milk per day for dairy visits",r._tab=r._tab||"dairy"),r}return e.jsxs("div",{className:"space-y-6 h-full",children:[e.jsx("header",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-500",children:"Create Farm Visit"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Create a visit (visit-level data plus farm-type specific details)"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:e.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>y("visit"),className:`px-3 py-1 rounded ${m==="visit"?"bg-indigo-600 text-white":"bg-gray-100"}`,children:"Visit"}),e.jsx("button",{type:"button",onClick:()=>y("layer"),className:`px-3 py-1 rounded ${m==="layer"?"bg-indigo-600 text-white":"bg-gray-100"}`,children:"Layer"}),e.jsx("button",{type:"button",onClick:()=>y("dairy"),className:`px-3 py-1 rounded ${m==="dairy"?"bg-indigo-600 text-white":"bg-gray-100"}`,children:"Dairy"})]}),p&&p.type==="error"&&e.jsx("div",{className:"mb-3 text-sm text-red-700",children:p.text})]}),m==="visit"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Farm Type"}),e.jsxs("select",{value:s.FarmTypeCode,onChange:t=>l(a=>({...a,FarmTypeCode:t.target.value})),className:"w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"LAYER",children:"Layer"}),e.jsx("option",{value:"DAIRY",children:"Dairy"})]}),u.FarmTypeCode&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:u.FarmTypeCode})]}),m==="visit"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Visit Date"}),e.jsx("input",{type:"datetime-local",value:s.VisitDate,onChange:t=>l(a=>({...a,VisitDate:t.target.value})),className:"w-full px-3 py-2 border rounded"}),u.VisitDate&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:u.VisitDate})]}),m==="visit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Farm ID"}),e.jsx("input",{value:s.FarmID||"",onChange:t=>l(a=>({...a,FarmID:t.target.value})),className:"w-full px-3 py-2 border rounded",placeholder:"GUID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Farmer"}),e.jsxs("select",{value:s.FarmerID||"",onChange:t=>l(a=>({...a,FarmerID:t.target.value})),className:"w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"",children:"-- select farmer --"}),j&&e.jsx("option",{disabled:!0,children:"Loading farmers..."}),P.map(t=>{const a=t.FarmerID||t.FarmerId||t.id||t.FarmerID,r=`${t.FirstName||t.firstName||""} ${t.LastName||t.lastName||""}`.trim()||t.Name||t.name||a;return e.jsx("option",{value:a,children:r},a)})]}),u.FarmOrFarmer&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:u.FarmOrFarmer})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Visit purpose"}),e.jsx("input",{value:s.VisitPurpose,onChange:t=>l(a=>({...a,VisitPurpose:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Location"}),e.jsx("input",{value:s.Location,onChange:t=>l(a=>({...a,Location:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),s.FarmTypeCode==="LAYER"&&e.jsxs(e.Fragment,{children:[m==="layer"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Breed"}),e.jsx("input",{value:s.Breed,onChange:t=>l(a=>({...a,Breed:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Flock size"}),e.jsx("input",{type:"number",value:s.FlockSize,onChange:t=>l(a=>({...a,FlockSize:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Age (weeks)"}),e.jsx("input",{type:"number",value:s.AgeInWeeks,onChange:t=>l(a=>({...a,AgeInWeeks:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Egg production (%)"}),e.jsx("input",{type:"number",step:"0.1",value:s.EggProductionPercent,onChange:t=>l(a=>({...a,EggProductionPercent:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Feeding Management"}),e.jsx("textarea",{value:s.FeedingManagement,onChange:t=>l(a=>({...a,FeedingManagement:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Feed intake per chicken (g)"}),e.jsx("input",{type:"number",step:"0.01",value:s.FeedIntakePerChickenGm,onChange:t=>l(a=>({...a,FeedIntakePerChickenGm:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Water intake per chicken"}),e.jsx("input",{type:"number",step:"0.01",value:s.WaterInTakePerChicken,onChange:t=>l(a=>({...a,WaterInTakePerChicken:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Feed leftover"}),e.jsx("input",{value:s.FeedLeftOver,onChange:t=>l(a=>({...a,FeedLeftOver:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"FLO how much per day"}),e.jsx("input",{value:s.FLOHowMuchPDay,onChange:t=>l(a=>({...a,FLOHowMuchPDay:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Water intake per day"}),e.jsx("input",{value:s.WaterIntakePerDay,onChange:t=>l(a=>({...a,WaterIntakePerDay:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Flock density"}),e.jsx("input",{value:s.FlockDensity,onChange:t=>l(a=>({...a,FlockDensity:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Avg body weight (kg)"}),e.jsx("input",{type:"number",step:"0.01",value:s.AvgBodyWeightKg,onChange:t=>l(a=>({...a,AvgBodyWeightKg:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Ventilation"}),e.jsx("input",{value:s.Ventilation,onChange:t=>l(a=>({...a,Ventilation:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"House temperature (Â°C)"}),e.jsx("input",{type:"number",step:"0.1",value:s.HouseTemperature,onChange:t=>l(a=>({...a,HouseTemperature:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Humidity (%)"}),e.jsx("input",{type:"number",step:"0.1",value:s.Humidity,onChange:t=>l(a=>({...a,Humidity:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Drinker type"}),e.jsx("input",{value:s.DrinkerType,onChange:t=>l(a=>({...a,DrinkerType:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Number of drinker"}),e.jsx("input",{type:"number",value:s.NumberofDrinker,onChange:t=>l(a=>({...a,NumberofDrinker:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Feeder type"}),e.jsx("input",{value:s.FeederType,onChange:t=>l(a=>({...a,FeederType:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Number of feeder"}),e.jsx("input",{type:"number",value:s.NumberofFeeder,onChange:t=>l(a=>({...a,NumberofFeeder:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!s.VaccinationsGiven,onChange:t=>l(a=>({...a,VaccinationsGiven:t.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Vaccinations given"})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Vaccination note"}),e.jsx("textarea",{value:s.VaccinationNote,onChange:t=>l(a=>({...a,VaccinationNote:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Biosecurity comment"}),e.jsx("textarea",{value:s.BiosecurityComment,onChange:t=>l(a=>({...a,BiosecurityComment:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Farm hygiene comment"}),e.jsx("textarea",{value:s.FarmHygieneComment,onChange:t=>l(a=>({...a,FarmHygieneComment:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Egg size avg weight (g)"}),e.jsx("input",{type:"number",step:"0.1",value:s.EggSizeAvgWeightGm,onChange:t=>l(a=>({...a,EggSizeAvgWeightGm:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Egg abnormality"}),e.jsx("textarea",{value:s.EggAbnormality,onChange:t=>l(a=>({...a,EggAbnormality:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Yolk color (score)"}),e.jsx("input",{type:"number",value:s.YolkColor,onChange:t=>l(a=>({...a,YolkColor:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Egg shell color (score)"}),e.jsx("input",{type:"number",value:s.EggShellColor,onChange:t=>l(a=>({...a,EggShellColor:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Egg production decline (prev 1 week)"}),e.jsx("textarea",{value:s.EggProductionDeclinePrev1Week,onChange:t=>l(a=>({...a,EggProductionDeclinePrev1Week:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Mortality total"}),e.jsx("input",{type:"number",value:s.MortalityTotal,onChange:t=>l(a=>({...a,MortalityTotal:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Mortality recent 2 weeks"}),e.jsx("input",{type:"number",value:s.MortalityRecent2Weeks,onChange:t=>l(a=>({...a,MortalityRecent2Weeks:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Disease history"}),e.jsx("textarea",{value:s.DiseaseHistory,onChange:t=>l(a=>({...a,DiseaseHistory:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Abnormal signs"}),e.jsx("textarea",{value:s.AbnormalSigns,onChange:t=>l(a=>({...a,AbnormalSigns:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Postmortem findings"}),e.jsx("textarea",{value:s.PostmortemFindings,onChange:t=>l(a=>({...a,PostmortemFindings:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Customer feedback on AKF"}),e.jsx("textarea",{value:s.CustomerFeedbackOnAKF,onChange:t=>l(a=>({...a,CustomerFeedbackOnAKF:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Recommendation given"}),e.jsx("textarea",{value:s.RecommendationGiven,onChange:t=>l(a=>({...a,RecommendationGiven:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!s.SampleTaken,onChange:t=>l(a=>({...a,SampleTaken:t.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Sample taken"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Sample type"}),e.jsx("input",{value:s.SampleType,onChange:t=>l(a=>({...a,SampleType:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Analysis request / notes"}),e.jsx("textarea",{value:s.AnalysisRequest,onChange:t=>l(a=>({...a,AnalysisRequest:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Any picture related to visit (URL)"}),e.jsx("input",{value:s.AnyPictureRelatedtoVisit,onChange:t=>l(a=>({...a,AnyPictureRelatedtoVisit:t.target.value})),className:"w-full px-3 py-2 border rounded"})]})]}),m==="layer"&&s.FarmTypeCode!=="LAYER"&&e.jsxs("div",{className:"md:col-span-2 text-sm text-slate-600",children:["Farm type is ",s.FarmTypeCode,". Switch to Layer to edit layer-specific data or change Farm Type to LAYER."]}),u.LayerHint&&m==="layer"&&e.jsx("div",{className:"md:col-span-2 text-xs text-yellow-700",children:u.LayerHint})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Visit details"})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Advisor"}),e.jsxs("select",{value:s.AdvisorID,onChange:t=>l(a=>({...a,AdvisorID:t.target.value})),className:"w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"",children:"-- select advisor --"}),j&&e.jsx("option",{disabled:!0,children:"Loading employees..."}),f.map(t=>{const a=t.EmployeeID||t.EmployeeId||t.id||t.EmployeeID,r=`${t.FirstName||t.firstName||""} ${t.LastName||t.lastName||""}`.trim()||t.Name||t.name||a;return e.jsx("option",{value:a,children:r},a)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Assigned to"}),e.jsxs("select",{value:s.AssignedTo,onChange:t=>l(a=>({...a,AssignedTo:t.target.value})),className:"w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"",children:"-- select employee --"}),j&&e.jsx("option",{disabled:!0,children:"Loading employees..."}),f.map(t=>{const a=t.EmployeeID||t.EmployeeId||t.id||t.EmployeeID,r=`${t.FirstName||t.firstName||""} ${t.LastName||t.lastName||""}`.trim()||t.Name||t.name||a;return e.jsx("option",{value:a,children:r},a)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Visit status ID"}),e.jsx("input",{value:s.VisitStatusID||"",onChange:t=>l(a=>({...a,VisitStatusID:t.target.value})),className:"w-full px-3 py-2 border rounded",placeholder:"GUID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Scheduled start time"}),e.jsx("input",{type:"time",value:s.ScheduledStartTime||"",onChange:t=>l(a=>({...a,ScheduledStartTime:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Scheduled end time"}),e.jsx("input",{type:"time",value:s.ScheduledEndTime||"",onChange:t=>l(a=>({...a,ScheduledEndTime:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Actual start time"}),e.jsx("input",{type:"datetime-local",value:s.ActualStartTime||"",onChange:t=>l(a=>({...a,ActualStartTime:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Actual end time"}),e.jsx("input",{type:"datetime-local",value:s.ActualEndTime||"",onChange:t=>l(a=>({...a,ActualEndTime:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Duration minutes"}),e.jsx("input",{type:"number",value:s.DurationMinutes||"",onChange:t=>l(a=>({...a,DurationMinutes:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Visit outcome"}),e.jsx("input",{value:s.VisitOutcome||"",onChange:t=>l(a=>({...a,VisitOutcome:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Findings"}),e.jsx("textarea",{value:s.Findings||"",onChange:t=>l(a=>({...a,Findings:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:3})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Recommendations"}),e.jsx("textarea",{value:s.Recommendations||"",onChange:t=>l(a=>({...a,Recommendations:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Next visit date"}),e.jsx("input",{type:"date",value:s.NextVisitDate||"",onChange:t=>l(a=>({...a,NextVisitDate:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Visit priority"}),e.jsxs("select",{value:s.VisitPriority||"Normal",onChange:t=>l(a=>({...a,VisitPriority:t.target.value})),className:"w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Normal",children:"Normal"}),e.jsx("option",{value:"High",children:"High"})]})]}),s.FarmTypeCode==="DAIRY"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Lactation cows"}),e.jsx("input",{type:"number",value:s.LactationCows,onChange:t=>l(a=>({...a,LactationCows:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Avg milk per cow (L/day)"}),e.jsx("input",{type:"number",step:"0.01",value:s.AvgMilkProductionPerDay,onChange:t=>l(a=>({...a,AvgMilkProductionPerDay:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Total milk per day (L)"}),e.jsx("input",{type:"number",step:"0.01",value:s.TotalMilkPerDay,onChange:t=>l(a=>({...a,TotalMilkPerDay:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Dry cows"}),e.jsx("input",{type:"number",value:s.DryCows,onChange:t=>l(a=>({...a,DryCows:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Heifers"}),e.jsx("input",{type:"number",value:s.Heifers,onChange:t=>l(a=>({...a,Heifers:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Calves"}),e.jsx("input",{type:"number",value:s.Calves,onChange:t=>l(a=>({...a,Calves:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Buls"}),e.jsx("input",{type:"number",value:s.Buls,onChange:t=>l(a=>({...a,Buls:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Body condition"}),e.jsx("input",{type:"number",step:"0.1",value:s.BodyCondition,onChange:t=>l(a=>({...a,BodyCondition:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Feeding per cow"}),e.jsx("input",{value:s.FeedingPerCow,onChange:t=>l(a=>({...a,FeedingPerCow:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"How they give for cows"}),e.jsx("input",{value:s.HowTheyGiveForCos,onChange:t=>l(a=>({...a,HowTheyGiveForCos:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!s.UsesConcentrate,onChange:t=>l(a=>({...a,UsesConcentrate:t.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Uses concentrate"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Which company"}),e.jsx("input",{value:s.WhichCompany,onChange:t=>l(a=>({...a,WhichCompany:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"List of ingredient / local mix"}),e.jsx("textarea",{value:s.ListofIngridiant,onChange:t=>l(a=>({...a,ListofIngridiant:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Has forage"}),e.jsx("input",{type:"checkbox",checked:!!s.HasForage,onChange:t=>l(a=>({...a,HasForage:t.target.checked}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Type of forage"}),e.jsx("input",{value:s.TypeOfForage,onChange:t=>l(a=>({...a,TypeOfForage:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Forage amount"}),e.jsx("input",{type:"number",value:s.ForageAmount,onChange:t=>l(a=>({...a,ForageAmount:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Sample collection"}),e.jsx("textarea",{value:s.SampleCollection,onChange:t=>l(a=>({...a,SampleCollection:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Vaccination history"}),e.jsx("textarea",{value:s.VaccinationHistory,onChange:t=>l(a=>({...a,VaccinationHistory:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Breeding history / method"}),e.jsx("textarea",{value:s.BreedingHistory,onChange:t=>l(a=>({...a,BreedingHistory:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Breeding method"}),e.jsx("input",{value:s.BreedingMethod,onChange:t=>l(a=>({...a,BreedingMethod:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Are they using Natural or AI"}),e.jsx("input",{value:s.AreTheyUsingNaturalorAI,onChange:t=>l(a=>({...a,AreTheyUsingNaturalorAI:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Insemination frequency"}),e.jsx("input",{value:s.InseminationFrequency,onChange:t=>l(a=>({...a,InseminationFrequency:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Calving interval (days)"}),e.jsx("input",{type:"number",value:s.CalvingInterval,onChange:t=>l(a=>({...a,CalvingInterval:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Age at first calving"}),e.jsx("input",{type:"number",value:s.AgeAtFirstCalving,onChange:t=>l(a=>({...a,AgeAtFirstCalving:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Litter condition"}),e.jsx("textarea",{value:s.LitterCondition,onChange:t=>l(a=>({...a,LitterCondition:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Max milk production per cow"}),e.jsx("input",{type:"number",step:"0.01",value:s.MaxMilkProductionPerCow,onChange:t=>l(a=>({...a,MaxMilkProductionPerCow:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Milk supply to"}),e.jsx("input",{value:s.MilkSupplyTo,onChange:t=>l(a=>({...a,MilkSupplyTo:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Milk price per liter"}),e.jsx("input",{type:"number",step:"0.01",value:s.MilkPricePerLitter,onChange:t=>l(a=>({...a,MilkPricePerLitter:t.target.value})),className:"w-full px-3 py-2 border rounded"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!s.Medication,onChange:t=>l(a=>({...a,Medication:t.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Medication administered"})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"What type of medication"}),e.jsx("textarea",{value:s.WhatTypeofMedication,onChange:t=>l(a=>({...a,WhatTypeofMedication:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Issues / complaints"}),e.jsx("textarea",{value:s.IssuesComplaints,onChange:t=>l(a=>({...a,IssuesComplaints:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Analyze requested / notes"}),e.jsx("textarea",{value:s.AnalyzeRequested,onChange:t=>l(a=>({...a,AnalyzeRequested:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Recommendation / advice"}),e.jsx("textarea",{value:s.RecommendationAdvice,onChange:t=>l(a=>({...a,RecommendationAdvice:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Feedback on AKF"}),e.jsx("textarea",{value:s.FeedBackOnAKF,onChange:t=>l(a=>({...a,FeedBackOnAKF:t.target.value})),className:"w-full px-3 py-2 border rounded",rows:2})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Any related evidence image (URL)"}),e.jsx("input",{value:s.AnyRelatedEvidenceImage,onChange:t=>l(a=>({...a,AnyRelatedEvidenceImage:t.target.value})),className:"w-full px-3 py-2 border rounded"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center justify-end gap-2 mt-2",children:[e.jsx("button",{type:"reset",onClick:()=>l(t=>({...t,VisitPurpose:"",Location:"",Breed:"",FlockSize:"",AgeInWeeks:"",EggProductionPercent:"",LactationCows:"",AvgMilkProductionPerDay:"",TotalMilkPerDay:""})),className:"px-3 py-2 border rounded",children:"Reset"}),e.jsxs("button",{type:"submit",disabled:C,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded",children:[" ",e.jsx(E,{className:"h-4 w-4"})," ",C?"Saving...":"Create Visit"]})]}),p&&e.jsx("div",{className:`md:col-span-2 text-sm ${p.type==="error"?"text-red-600":"text-green-600"}`,children:p.text})]})})]})}export{H as default};
