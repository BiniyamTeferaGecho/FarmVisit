import{G as j,u as v,r as l,j as e,ai as N,aj as C,a0 as P}from"./index-gIg6QK8U.js";import{S}from"./save-DdPekitn.js";const z=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],y=j("key",z);const I=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],F=j("lock",I),u=({icon:c,label:a,value:r,onChange:n})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-left block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1",children:a}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400",children:c}),e.jsx("input",{type:"password",value:r,onChange:n,className:"w-full mt-1 p-2 pl-10 border rounded-lg bg-slate-50 dark:bg-slate-700 border-slate-300 dark:border-slate-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]});function D({modal:c=!1}){const{user:a}=v(),[r,n]=l.useState(""),[o,g]=l.useState(""),[h,m]=l.useState(""),[p,b]=l.useState(!1),[i,t]=l.useState(null),f=a?.userId||a?.UserID||a?.id||null,k=async s=>{if(s&&s.preventDefault(),t(null),!r||!o){t({type:"error",text:"Please fill out all password fields."});return}if(o!==h){t({type:"error",text:"New password and confirmation do not match."});return}b(!0);try{const d={UserID:f,CurrentPassword:r,NewPassword:o,ChangedBy:f},x=await P.post("/users/change-password",d);x?.data?.success?(t({type:"success",text:x.data.message||"Password changed successfully!"}),n(""),g(""),m("")):t({type:"error",text:x?.data?.message||"Failed to change password."})}catch(d){console.error("Change password error",d),t({type:"error",text:d?.response?.data?.message||d.message||"An unexpected error occurred."})}finally{b(!1)}},w=e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-left text-3xl font-bold text-slate-900 dark:text-white",children:"Security Settings"}),e.jsx("p",{className:"text-left text-md text-slate-600 dark:text-slate-400 mt-1",children:"Update your password to keep your account secure."})]}),i&&e.jsx("div",{className:`mb-4 p-4 rounded-lg ${i.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-800 dark:text-green-200":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200"}`,children:i.text}),e.jsxs("form",{onSubmit:k,className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg p-8 space-y-6",children:[e.jsx(u,{icon:e.jsx(F,{size:18}),label:"Current Password",value:r,onChange:s=>n(s.target.value)}),e.jsx(u,{icon:e.jsx(y,{size:18}),label:"New Password",value:o,onChange:s=>g(s.target.value)}),e.jsx(u,{icon:e.jsx(y,{size:18}),label:"Confirm New Password",value:h,onChange:s=>m(s.target.value)}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200 dark:border-slate-700",children:e.jsx("button",{type:"submit",disabled:p,className:"px-6 py-3 bg-blue-600 text-white rounded-lg flex items-center gap-2 hover:bg-blue-700 disabled:bg-blue-400",children:p?"Changing...":e.jsxs(e.Fragment,{children:[e.jsx(S,{size:18})," Change Password"]})})})]})]});return c?w:e.jsxs("div",{className:"min-h-screen bg-slate-100 dark:bg-slate-900",children:[e.jsx("div",{style:{height:70},className:"fixed top-0 left-0 right-0 z-30",children:e.jsx(N,{onToggleSidebar:()=>{},onToggleCollapse:()=>{}})}),e.jsxs("div",{style:{paddingTop:70},className:"flex",children:[e.jsx(C,{isOpen:!1,isCollapsed:!1,active:"dashboard",onChange:()=>{},onClose:()=>{},width:72,minWidth:64}),e.jsx("main",{className:"flex-1 p-6",children:w})]})]})}export{D as default};
